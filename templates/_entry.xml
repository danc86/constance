<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1.dtd">
<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:py="http://genshi.edgewall.org/"
	 py:strip="True"
	 py:def="show_entry(entry, show_comments=True)">

<div class="entry">

	<h3 class="entrytitle" id="post-${entry.id}"><a href="${BASE_URL}/${entry.id}" rel="bookmark">${entry.title}</a></h3>

	<div class="entrymeta">
		Posted ${entry.publication_date.strftime(str('%-1d %B %Y'))}
		<py:if test="entry.categories">
			in <a py:for="category in entry.categories" href="${BASE_URL}/+categories/${category}">${category}</a>
		</py:if>
		<py:if test="not show_comments and entry.has_comments()">
			Â·
			<a href="${BASE_URL}/${entry.id}#comments">
				Comments
				<py:if test="len(entry.comments()) > 0">(${len(entry.comments())})</py:if>
			</a>
		</py:if>
	</div>
  
	<div class="entrybody">
		${Markup(entry.body)}
		<p py:if="entry.tags">
			<img src="${BASE_URL}/static/images/tag_blue.png" alt="Tags:" />
			<a py:for="tag in entry.tags" rel="tag" href="${BASE_URL}/+tags/${tag}">${tag}</a>
		</p>
	</div>

</div>

<div id="commentblock"
	 py:if="show_comments and entry.has_comments()"
	 py:with="comments = sorted(entry.comments(), key=lambda c: c.date)">
	<h2 id="comments">${len(comments) == 1 and '1 comment' or '%d comments' % len(comments)} so far</h2>
    <ol class="commentlist" id="commentlist">
		<li py:for="n, comment in enumerate(comments)"
			class="${(n % 2) and 'alt' or 'standard'}"
			id="comment-${comment.id}">
			<div class="commentname">
				<a py:strip="not comment.author_url" href="${comment.author_url}">${comment.author_name()}</a>
				on <a href="#comment-${comment.id}">${comment.date.strftime(str('%-1d %B %Y'))}</a>
			</div>
			<div class="commenttext">
				<div class="commentp">
					${Markup(comment.body)}
				</div>
			</div>
		</li>
	</ol>
</div>

</div>
